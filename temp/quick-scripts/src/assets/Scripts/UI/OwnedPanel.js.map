{"version":3,"sources":["assets\\Scripts\\UI\\OwnedPanel.js"],"names":["ItemType","require","OwnedCarPanel","OwnedMatePanel","OwnedHousePanel","OwnedPanel","cc","Class","Component","properties","ownedCarScroll","ownedMateScroll","ownedHouseScroll","togMate","Toggle","togCar","togHouse","OpenMatePanel","Mgr","AudioMgr","playSFX","node","active","ShowPanel","OpenHousePanel","OpenCarPanel","isChecked","judeIsInitAndRefresh","itemType","data","flag","Car","ownNum","House","Mate","UpLv","children","ownedParent","i","length","sc","getComponent","Id","Refresh","ClosePanel","module","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var ItemType = require(\"ItemType\");\r\nvar OwnedCarPanel = require(\"OwnedCarPanel\");\r\nvar OwnedMatePanel = require(\"OwnedMatePanel\");\r\nvar OwnedHousePanel = require(\"OwnedHousePanel\");\r\n\r\nvar OwnedPanel = cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n       ownedCarScroll:OwnedCarPanel,\r\n       ownedMateScroll:OwnedMatePanel,\r\n       ownedHouseScroll:OwnedHousePanel,\r\n\r\n       togMate:cc.Toggle,\r\n       togCar:cc.Toggle,\r\n       togHouse:cc.Toggle,\r\n    },\r\n\r\n    OpenMatePanel:function () {\r\n        cc.Mgr.AudioMgr.playSFX(\"click\");\r\n        this.ownedMateScroll.node.active = true;\r\n        this.ownedHouseScroll.node.active = false;\r\n        this.ownedCarScroll.node.active = false;\r\n\r\n        this.ownedMateScroll.ShowPanel();\r\n    },\r\n\r\n    OpenHousePanel:function () {\r\n        cc.Mgr.AudioMgr.playSFX(\"click\");\r\n        this.ownedMateScroll.node.active = false;\r\n        this.ownedHouseScroll.node.active = true;\r\n        this.ownedCarScroll.node.active = false;\r\n\r\n        this.ownedHouseScroll.ShowPanel();\r\n    },\r\n\r\n    OpenCarPanel:function () {\r\n        cc.Mgr.AudioMgr.playSFX(\"click\");\r\n        this.ownedMateScroll.node.active = false;\r\n        this.ownedHouseScroll.node.active = false;\r\n        this.ownedCarScroll.node.active = true;\r\n\r\n        this.ownedCarScroll.ShowPanel();\r\n    },\r\n\r\n    ShowPanel:function () {\r\n        if(this.togMate.isChecked == true)\r\n        {\r\n            this.OpenMatePanel();\r\n        }\r\n        else if(this.togHouse.isChecked == true)\r\n        {\r\n            this.OpenHousePanel();\r\n        }\r\n        else if(this.togCar.isChecked == true)\r\n        {\r\n            this.OpenCarPanel();\r\n        }\r\n\r\n        /*\r\n        var carList = cc.Mgr.UserDataMgr.getOwnDataListByType(ItemType.Car);\r\n        for (var i = carList.length - 1; i >= 0; i--) {\r\n            if(this.judeIsInitAndRefresh(ItemType.Car, carList[i]))\r\n            {\r\n                //cc.log(\"不用再实例化，已经有了\");\r\n            }\r\n            else\r\n            {\r\n                //cc.log(\"实例化车子\");\r\n                var obj = cc.instantiate(this.ownedPre);\r\n                obj.parent = this.ownedParent;\r\n                obj.getComponent(\"BelongItem\").init(carList[i], ItemType.Car);\r\n            }\r\n        }\r\n\r\n        var houseList = cc.Mgr.UserDataMgr.getOwnDataListByType(ItemType.House);\r\n        for (var i = houseList.length - 1; i >= 0; i--) {\r\n            if(this.judeIsInitAndRefresh(ItemType.House, houseList[i]))\r\n            {\r\n                //cc.log(\"不用再实例化，已经有了\");\r\n            }\r\n            else\r\n            {\r\n                //cc.log(\"实例化房子\");\r\n                var obj = cc.instantiate(this.ownedPre);\r\n                obj.parent = this.ownedParent;\r\n                obj.getComponent(\"BelongItem\").init(houseList[i], ItemType.House);\r\n            }\r\n        }\r\n\r\n        var mateList = cc.Mgr.UserDataMgr.getOwnDataListByType(ItemType.Mate);\r\n        for (var i = mateList.length - 1; i >= 0; i--) {\r\n            if(this.judeIsInitAndRefresh(ItemType.Mate, mateList[i]))\r\n            {\r\n                //cc.log(\"不用再实例化，已经有了\");\r\n            }\r\n            else\r\n            {\r\n                //cc.log(\"实例化伴侣\");\r\n                var obj = cc.instantiate(this.ownedPre);\r\n                obj.parent = this.ownedParent;\r\n                obj.getComponent(\"BelongItem\").init(mateList[i], ItemType.Mate);\r\n            }\r\n        }\r\n        */\r\n    },\r\n\r\n    //判断这个 obj是否已经实例化了\r\n    judeIsInitAndRefresh:function(itemType,data){\r\n        var flag = false;\r\n        if(itemType == ItemType.Car)\r\n        {\r\n            if(data.ownNum > 0)\r\n                flag = true;\r\n        }\r\n        else if(itemType == ItemType.House)\r\n        {\r\n            //cc.log(\"+++++++++++\" + data.ownNum);\r\n            if(data.ownNum > 0)\r\n                flag = true;\r\n        }\r\n        else if(itemType == ItemType.Mate)\r\n        {\r\n            if(data.UpLv == true)\r\n                flag = true;\r\n        }\r\n\r\n        var children = this.ownedParent.children;\r\n        for (var i = children.length - 1; i >= 0; i--) { \r\n            var sc = children[i].getComponent(\"BelongItem\");\r\n            if(sc != null)\r\n            {\r\n                if(itemType == sc.itemType && data.Id == sc.Id)\r\n                {\r\n                    if(itemType == ItemType.Car || itemType == ItemType.House)\r\n                    {\r\n                        if(data.ownNum > 0)\r\n                        {\r\n                            children[i].active = true;\r\n                            sc.Refresh(data);\r\n                        }\r\n                        else\r\n                        {\r\n                            children[i].active = false;\r\n                        }\r\n                    }\r\n                    else if(itemType == ItemType.Mate)\r\n                    {\r\n                        if(data.UpLv == true)\r\n                            children[i].active = true;\r\n                        else\r\n                            children[i].active = false;\r\n                    }\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        if(flag == true)\r\n            return false;\r\n        else\r\n            return true;\r\n    },\r\n\r\n    ClosePanel:function(){\r\n        cc.Mgr.AudioMgr.playSFX(\"click\");\r\n        this.node.active = false;\r\n    },  \r\n});\r\nmodule.exports = OwnedPanel;"]}