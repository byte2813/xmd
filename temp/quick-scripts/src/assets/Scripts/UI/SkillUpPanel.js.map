{"version":3,"sources":["assets\\Scripts\\UI\\SkillUpPanel.js"],"names":["SkillPanel","require","ItemType","SkillUpPanel","cc","Class","Component","properties","skillPanel","titleLbl","Label","Data","DesNull","DesNormal","Node","des1","des2","costLbl","ShowPanel","data","string","name","Uplv","level","node","active","Mgr","global","getTranslation","desId","bonuscur","MapDataMgr","getSkillAddBonusByTwoIdAndLv","Id","subId","bonusnext","getUpgradeCostByTwoId","ClickUpGrade","ClosePanel","re","UserDataMgr","UpGradeSkill","AudioMgr","playSFX","RefreshPanel","module","exports"],"mappings":";;;;;;AAAA,IAAIA,UAAU,GAAGC,OAAO,CAAC,YAAY,CAAC;AACtC,IAAIC,QAAQ,GAAGD,OAAO,CAAC,UAAU,CAAC;AAClC,IAAIE,YAAY,GAAGC,EAAE,CAACC,KAAK,CAAC;EACxB,WAASD,EAAE,CAACE,SAAS;EAErBC,UAAU,EAAE;IACRC,UAAU,EAACR,UAAU;IACrBS,QAAQ,EAACL,EAAE,CAACM,KAAK;IACjBC,IAAI,EAAC,IAAI;IACTC,OAAO,EAACR,EAAE,CAACM,KAAK;IAChBG,SAAS,EAACT,EAAE,CAACU,IAAI;IAEjBC,IAAI,EAACX,EAAE,CAACM,KAAK;IACbM,IAAI,EAACZ,EAAE,CAACM,KAAK;IACbO,OAAO,EAACb,EAAE,CAACM;EACf,CAAC;EAEDQ,SAAS,EAAC,SAAAA,UAASC,IAAI,EAAC;IACpB,IAAI,CAACR,IAAI,GAAG,IAAI;IAChB,IAAI,CAACA,IAAI,GAAGQ,IAAI;IAChB,IAAI,CAACV,QAAQ,CAACW,MAAM,GAAGD,IAAI,CAACE,IAAI;IAChC;IACA,IAAGF,IAAI,CAACG,IAAI,IAAIH,IAAI,CAACI,KAAK,EAC1B;MACI,IAAI,CAACX,OAAO,CAACY,IAAI,CAACC,MAAM,GAAG,IAAI;MAC/B,IAAI,CAACZ,SAAS,CAACY,MAAM,GAAG,KAAK;MAC7B,IAAI,CAACb,OAAO,CAACQ,MAAM,GAAGhB,EAAE,CAACsB,GAAG,CAACC,MAAM,CAACC,cAAc,CAAC,KAAK,GAACT,IAAI,CAACU,KAAK,CAAC,GAAE,WAAW;IACrF,CAAC,MAED;MACI,IAAI,CAACjB,OAAO,CAACY,IAAI,CAACC,MAAM,GAAG,KAAK;MAChC,IAAI,CAACZ,SAAS,CAACY,MAAM,GAAG,IAAI;MAC5B,IAAIK,QAAQ,GAAG1B,EAAE,CAACsB,GAAG,CAACK,UAAU,CAACC,4BAA4B,CAACb,IAAI,CAACc,EAAE,EAAEd,IAAI,CAACe,KAAK,EAAEf,IAAI,CAACI,KAAK,CAAC;MAC9F,IAAIY,SAAS,GAAG/B,EAAE,CAACsB,GAAG,CAACK,UAAU,CAACC,4BAA4B,CAACb,IAAI,CAACc,EAAE,EAAEd,IAAI,CAACe,KAAK,EAAGf,IAAI,CAACI,KAAK,GAAC,CAAC,CAAE;MAEnG,IAAI,CAACR,IAAI,CAACK,MAAM,GAAGhB,EAAE,CAACsB,GAAG,CAACC,MAAM,CAACC,cAAc,CAAC,KAAK,GAACT,IAAI,CAACU,KAAK,CAAC;MACjE,IAAI,CAACZ,OAAO,CAACG,MAAM,GAAGhB,EAAE,CAACsB,GAAG,CAACK,UAAU,CAACK,qBAAqB,CAACjB,IAAI,CAACc,EAAE,EAAEd,IAAI,CAACe,KAAK,EAAGf,IAAI,CAACI,KAAK,GAAG,CAAC,CAAE;MACpG,IAAGJ,IAAI,CAACI,KAAK,IAAI,CAAC,EAClB;QACI,IAAI,CAACR,IAAI,CAACK,MAAM,GAAGhB,EAAE,CAACsB,GAAG,CAACC,MAAM,CAACC,cAAc,CAAC,KAAK,GAACT,IAAI,CAACU,KAAK,CAAC;QACjE,IAAGM,SAAS,GAAG,CAAC,EACZ,IAAI,CAACnB,IAAI,CAACI,MAAM,GAAIe,SAAS,GAAG,GAAG,GAAI,GAAG,CAAC,KAE3C,IAAI,CAACnB,IAAI,CAACI,MAAM,GAAGe,SAAS;MACpC,CAAC,MAED;QACI,IAAGA,SAAS,GAAG,CAAC,EACZ,IAAI,CAACnB,IAAI,CAACI,MAAM,GAAIU,QAAQ,GAAG,GAAG,GAAI,MAAM,GAAIK,SAAS,GAAG,GAAI,CAAC,KAEjE,IAAI,CAACnB,IAAI,CAACI,MAAM,GAAGU,QAAQ,GAAE,GAAG,GAACK,SAAS;MAClD;IACJ;EACJ,CAAC;EAEDE,YAAY,EAAC,SAAAA,aAAA,EAAU;IACnB,IAAG,IAAI,CAAC1B,IAAI,CAACW,IAAI,IAAI,IAAI,CAACX,IAAI,CAACY,KAAK,EACpC;MACI,IAAI,CAACe,UAAU,EAAE;MACjB;IACJ;IAEA,IAAIC,EAAE,GAAGnC,EAAE,CAACsB,GAAG,CAACc,WAAW,CAACC,YAAY,CAAC,IAAI,CAAC9B,IAAI,CAACsB,EAAE,EAAE,IAAI,CAACtB,IAAI,CAACuB,KAAK,EAAG,IAAI,CAACvB,IAAI,CAACY,KAAK,GAAG,CAAC,CAAE;IAC9F,IAAGgB,EAAE,IAAI,KAAK,EACd;MACInC,EAAE,CAACsB,GAAG,CAACgB,QAAQ,CAACC,OAAO,CAAC,OAAO,CAAC;MAChC,IAAI,CAAC/B,OAAO,CAACY,IAAI,CAACC,MAAM,GAAG,IAAI;MAC/B,IAAI,CAACZ,SAAS,CAACY,MAAM,GAAG,KAAK;MAC7B,IAAI,CAACb,OAAO,CAACQ,MAAM,GAAG,2BAA2B;IACrD,CAAC,MAED;MACI,IAAI,CAACZ,UAAU,CAACoC,YAAY,EAAE;MAC9B;MACA,IAAI,CAACN,UAAU,EAAE;IACrB;EAEJ,CAAC;EAEDA,UAAU,EAAC,SAAAA,WAAA,EAAU;IACjBlC,EAAE,CAACsB,GAAG,CAACgB,QAAQ,CAACC,OAAO,CAAC,OAAO,CAAC;IAChC,IAAI,CAACnB,IAAI,CAACC,MAAM,GAAG,KAAK;EAC5B;AACJ,CAAC,CAAC;AACFoB,MAAM,CAACC,OAAO,GAAG3C,YAAY","sourceRoot":"/","sourcesContent":["var SkillPanel = require(\"SkillPanel\");\r\nvar ItemType = require(\"ItemType\");\r\nvar SkillUpPanel = cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        skillPanel:SkillPanel,\r\n        titleLbl:cc.Label,\r\n        Data:null,\r\n        DesNull:cc.Label,\r\n        DesNormal:cc.Node,\r\n\r\n        des1:cc.Label,\r\n        des2:cc.Label,\r\n        costLbl:cc.Label,\r\n    },\r\n\r\n    ShowPanel:function(data){\r\n        this.Data = null;\r\n        this.Data = data;\r\n        this.titleLbl.string = data.name;\r\n        //cc.log(\"草泥马哦\" + this.Data.level);\r\n        if(data.Uplv == data.level)\r\n        {\r\n            this.DesNull.node.active = true;\r\n            this.DesNormal.active = false;\r\n            this.DesNull.string = cc.Mgr.global.getTranslation(\"Tf_\"+data.desId)+ \"\\n技能已升至满级\";\r\n        }\r\n        else\r\n        {\r\n            this.DesNull.node.active = false;\r\n            this.DesNormal.active = true;\r\n            var bonuscur = cc.Mgr.MapDataMgr.getSkillAddBonusByTwoIdAndLv(data.Id, data.subId, data.level);\r\n            var bonusnext = cc.Mgr.MapDataMgr.getSkillAddBonusByTwoIdAndLv(data.Id, data.subId, (data.level+1));\r\n            \r\n            this.des1.string = cc.Mgr.global.getTranslation(\"Tf_\"+data.desId);\r\n            this.costLbl.string = cc.Mgr.MapDataMgr.getUpgradeCostByTwoId(data.Id, data.subId, (data.level + 1));\r\n            if(data.level == 0)\r\n            {\r\n                this.des1.string = cc.Mgr.global.getTranslation(\"Tf_\"+data.desId);\r\n                if(bonusnext < 1)\r\n                    this.des2.string = (bonusnext * 100) + \"%\";\r\n                else\r\n                    this.des2.string = bonusnext;\r\n            }\r\n            else\r\n            {\r\n                if(bonusnext < 1)\r\n                    this.des2.string = (bonuscur * 100) + \"% - \" + (bonusnext * 100);\r\n                else\r\n                    this.des2.string = bonuscur +\"—\"+bonusnext;\r\n            }\r\n        }\r\n    },\r\n\r\n    ClickUpGrade:function(){\r\n        if(this.Data.Uplv == this.Data.level)\r\n        {\r\n            this.ClosePanel();\r\n            return;\r\n        }\r\n\r\n        var re = cc.Mgr.UserDataMgr.UpGradeSkill(this.Data.Id, this.Data.subId, (this.Data.level + 1));\r\n        if(re == false)\r\n        {\r\n            cc.Mgr.AudioMgr.playSFX(\"click\");\r\n            this.DesNull.node.active = true;\r\n            this.DesNormal.active = false;\r\n            this.DesNull.string = \"升级技能失败\\n(技能点不足或者未点亮上一个天赋)\";\r\n        }\r\n        else\r\n        {\r\n            this.skillPanel.RefreshPanel();\r\n            //cc.Mgr.UserDataMgr.SkillBonusPoint -= cc.Mgr.MapDataMgr.getUpgradeCostByTwoId(this.Data.Id, this.Data.subId, (this.Data.level + 1));\r\n            this.ClosePanel();\r\n        }\r\n\r\n    },\r\n\r\n    ClosePanel:function(){\r\n        cc.Mgr.AudioMgr.playSFX(\"click\");\r\n        this.node.active = false;\r\n    },\r\n});\r\nmodule.exports = SkillUpPanel;\r\n"]}