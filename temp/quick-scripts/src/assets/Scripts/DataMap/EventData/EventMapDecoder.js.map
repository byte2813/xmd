{"version":3,"sources":["assets\\Scripts\\DataMap\\EventData\\EventMapDecoder.js"],"names":["EventData","require","EventCost","EventResult","EventMapDecoder","cc","Class","Component","properties","jsonName","eventList","type","DecodeJson","event","self","reCb","loader","loadRes","error","obj","jsonRoot","json","events","i","length","eventData","Id","name","desId","j","cost","cData","dt","costType","costNum","Yresult","data","rewardType","rewardNum","rewardId","YResults","Nresult","NResults","getDataByItemId","itemId","getJsonLength","getDataList","module","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var EventData = require(\"EventTipData\");\r\nvar EventCost = require(\"EventCost\");\r\nvar EventResult = require(\"EventResult\");\r\nvar EventMapDecoder = cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        jsonName:\"events\",\r\n        eventList:{\r\n        \tdefault:[],\r\n        \ttype:[EventData],\r\n        },\r\n    },\r\n\r\n    //解析数据\r\n    DecodeJson:function (event) {\r\n        //cc.log(\"===解析事件数据===\");\r\n        var self = this;\r\n        self.reCb = event;\r\n        cc.loader.loadRes(\"json/\"+self.jsonName, function (error, obj) {\r\n            if(error)\r\n            {\r\n                //cc.log(\"+++解析出错，查下json+++\" + error);\r\n                self.reCb(false);\r\n                return;\r\n            }\r\n            \r\n            var jsonRoot = obj.json.events;\r\n            //cc.log(\"===数据长度===\" + jsonRoot.length);\r\n            for (var i = 0; i < jsonRoot.length; i++) {\r\n                var eventData = new EventData();\r\n                eventData.Id = jsonRoot[i].Id;\r\n                //eventData.icon = jsonRoot[i].icon;\r\n                eventData.name = jsonRoot[i].name;\r\n                eventData.desId = jsonRoot[i].desId;\r\n\r\n                //消耗\r\n                for (var j = 0; j < jsonRoot[i].cost.length ; j++) {\r\n                \tvar cData = new EventCost();\r\n                \tvar dt = jsonRoot[i].cost[j];\r\n                \tcData.costType = dt[0];\r\n                \tcData.costNum = dt[1];\r\n                \tcData.desId = dt[2];\r\n                \teventData.cost[j] = cData;\r\n                }\r\n                //正向两种结果\r\n                for (var j = 0; j < jsonRoot[i].Yresult.length; j++) {\r\n                    var cData = new EventResult();\r\n                    var data = jsonRoot[i].Yresult[j];\r\n                    cData.rewardType = data[0];\r\n                    cData.rewardNum = data[1];\r\n                    cData.rewardId = data[2]; //如果奖励的是金钱等  则id 为0\r\n                    cData.desId = data[3];\r\n                    eventData.YResults[j] =  cData;\r\n                }\r\n                //负向两种结果\r\n                for (var j = 0; j < jsonRoot[i].Nresult.length; j++) {\r\n                    var cData = new EventResult();\r\n                    var data = jsonRoot[i].Nresult[j];\r\n                    cData.rewardType = data[0];\r\n                    cData.rewardNum = data[1];\r\n                    cData.rewardId = data[2]; //如果奖励的是金钱等  则id 为0\r\n                    cData.desId = data[3];\r\n                    eventData.NResults[j] =  cData;\r\n                }\r\n                self.eventList[i] = eventData; \r\n            }\r\n            self.reCb(true);\r\n        });\r\n    },\r\n\r\n    //通过itemid获取数据\r\n    getDataByItemId:function(itemId){\r\n        var data = null;\r\n        for (var i = this.eventList.length - 1; i >= 0; i--) {\r\n            if(itemId == this.eventList[i].Id)\r\n            {\r\n                data = this.eventList[i];\r\n                break;\r\n            }\r\n        }\r\n        return data;\r\n    },\r\n\r\n     getJsonLength:function(){\r\n        return this.eventList.length\r\n    },\r\n\r\n    getDataList:function(){\r\n        return this.eventList;\r\n    },\r\n   \r\n});\r\nmodule.exports = EventMapDecoder;\r\n"]}