
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Scripts/UI/MarketTipPanel.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '3b6091ONMZPw7fhwHDkwbmF', 'MarketTipPanel');
// Scripts/UI/MarketTipPanel.js

"use strict";

var MarketTipItem = require("MarketTipItem");
var MarketTipPanel = cc.Class({
  "extends": cc.Component,
  properties: {
    TipList: {
      "default": [],
      type: [MarketTipItem]
    },
    DesLbl: cc.Label,
    IntoNode: cc.Node,
    IntoDes: cc.Label,
    IntoDesNull: cc.Node
  },
  ClosePanel: function ClosePanel() {
    cc.Mgr.AudioMgr.playSFX("click");
    this.node.active = false;

    //弹出计算股票收益
    if (cc.Mgr.UserDataMgr.CanGetStockProfit == true && cc.Mgr.global.showStockProfit == true) {
      var bonus = 0;
      var Id = -1;
      for (var i = cc.Mgr.UserDataMgr.CompanyList.length - 1; i >= 0; i--) {
        var da = cc.Mgr.UserDataMgr.CompanyList[i];
        if (da.stockNum > 0) {
          Id = da.Id;
          bonus += Math.floor(da.stockNum * da.stockPrice * (da.bonusRatio + cc.Mgr.UserDataMgr.StockAddBonus / 100));
        }
      }
      var param = {};
      param.forWhat = "StockBonus";
      param.bonus = bonus;
      param.Id = Id;
      cc.director.GlobalEvent.emit(cc.Mgr.Event.OpenCommonTip, param);
      cc.Mgr.global.showStockProfit = false;
    }
    if (cc.Mgr.global.tutorialStep == 11 && cc.Mgr.UserDataMgr.tutorialInMarket == false)
      //引导步骤 采用 11 表示第一个大步骤 第一小步
      {
        var dt = {};
        dt.step = 11;
        cc.director.GlobalEvent.emit(cc.Mgr.Event.OpenTutorial, dt);
      }
  },
  ShowPanel: function ShowPanel(param) {
    for (var i = this.TipList.length - 1; i >= 0; i--) {
      this.TipList[i].node.active = false;
    }
    this.IntoDes.string = "";
    this.IntoDesNull.active = false;
    //-2表示暴跌 -1表示跌了  0 表示稳定  1有所增长 2表示暴涨
    var list = this.CheckShowDes(param);
    if (list.length == 0) {
      this.DesLbl.node.active = true;
      this.DesLbl.string = cc.Mgr.global.getTranslation("Market_25");
    } else {
      this.DesLbl.node.active = false;
      for (var i = 0; i <= list.length - 1; i++) {
        var des = this.DickDes(list[i].State, list[i].name, list[i].Id);
        this.TipList[i].node.active = true;
        var par = {};
        par.des = des;
        par.Id = list[i].Id;
        this.TipList[i].SetData(par);
      }
    }
  },
  DickDes: function DickDes(State, name, Id) {
    var des = "";
    if (State == 0) {
      var desId = "Market_" + (2 * Id - 1);
      //des = cc.Mgr.global.getTranslation(desId);
    } else if (State == 2) {
      var desId = "Market_" + 2 * Id;
      //des = cc.Mgr.global.getTranslation(desId);;
    }

    var re = {};
    re.State = State;
    re.desId = desId;
    return re;
  },
  CheckShowDes: function CheckShowDes(param) {
    var list = [];
    var checkNum = 0;
    var rem = [];
    for (var i = param.length - 1; i >= 0; i--) {
      if (param[i].State != null) {
        if (param[i].State != 1) {
          list.push(param[i]);
          checkNum += 1;
        }
        if (param[i].State != 2 && param[i].Id != 3)
          //Id 为3 是字画还是黄金来着
          {
            rem.push(param[i]);
          }
      }
    }
    cc.Mgr.global.GoodsForeId = -1;
    if (checkNum <= 3 && cc.Mgr.UserDataMgr.Age >= 30 && rem.length > 0) {
      var seed = Math.random();
      if (seed < 0.4) {
        var d = Math.floor(Math.random() * rem.length);
        cc.Mgr.global.GoodsForeId = rem[d].Id;
        this.IntoDes.string = cc.Mgr.global.getTranslation("goods_" + rem[d].Id) + "下一年可能出现涨价" + "\n(前瞻有风险,盈亏自负)";
      } else {
        this.IntoDesNull.active = true;
      }
    } else {
      this.IntoDesNull.active = true;
    }
    return list;
  }
});
module.exports = MarketTipPanel;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcU2NyaXB0c1xcVUlcXE1hcmtldFRpcFBhbmVsLmpzIl0sIm5hbWVzIjpbIk1hcmtldFRpcEl0ZW0iLCJyZXF1aXJlIiwiTWFya2V0VGlwUGFuZWwiLCJjYyIsIkNsYXNzIiwiQ29tcG9uZW50IiwicHJvcGVydGllcyIsIlRpcExpc3QiLCJ0eXBlIiwiRGVzTGJsIiwiTGFiZWwiLCJJbnRvTm9kZSIsIk5vZGUiLCJJbnRvRGVzIiwiSW50b0Rlc051bGwiLCJDbG9zZVBhbmVsIiwiTWdyIiwiQXVkaW9NZ3IiLCJwbGF5U0ZYIiwibm9kZSIsImFjdGl2ZSIsIlVzZXJEYXRhTWdyIiwiQ2FuR2V0U3RvY2tQcm9maXQiLCJnbG9iYWwiLCJzaG93U3RvY2tQcm9maXQiLCJib251cyIsIklkIiwiaSIsIkNvbXBhbnlMaXN0IiwibGVuZ3RoIiwiZGEiLCJzdG9ja051bSIsIk1hdGgiLCJmbG9vciIsInN0b2NrUHJpY2UiLCJib251c1JhdGlvIiwiU3RvY2tBZGRCb251cyIsInBhcmFtIiwiZm9yV2hhdCIsImRpcmVjdG9yIiwiR2xvYmFsRXZlbnQiLCJlbWl0IiwiRXZlbnQiLCJPcGVuQ29tbW9uVGlwIiwidHV0b3JpYWxTdGVwIiwidHV0b3JpYWxJbk1hcmtldCIsImR0Iiwic3RlcCIsIk9wZW5UdXRvcmlhbCIsIlNob3dQYW5lbCIsInN0cmluZyIsImxpc3QiLCJDaGVja1Nob3dEZXMiLCJnZXRUcmFuc2xhdGlvbiIsImRlcyIsIkRpY2tEZXMiLCJTdGF0ZSIsIm5hbWUiLCJwYXIiLCJTZXREYXRhIiwiZGVzSWQiLCJyZSIsImNoZWNrTnVtIiwicmVtIiwicHVzaCIsIkdvb2RzRm9yZUlkIiwiQWdlIiwic2VlZCIsInJhbmRvbSIsImQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLGFBQWEsR0FBR0MsT0FBTyxDQUFDLGVBQWUsQ0FBQztBQUM1QyxJQUFJQyxjQUFjLEdBQUdDLEVBQUUs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QUFJLENBQUNaLFdBQVcsQ0FBQ00sTUFBTSxHQUFHLElBQUk7TUFDbEM7SUFDSixDQUFDLE1BRUQ7TUFDSSxJQUFJLENBQUNOLFdBQVcsQ0FBQ00sTUFBTSxHQUFHLElBQUk7SUFDbEM7SUFDQSxPQUFPK0IsSUFBSTtFQUNmO0FBQ0osQ0FBQyxDQUFDO0FBQ0ZtQixNQUFNLENBQUNDLE9BQU8sR0FBR3JFLGNBQWMiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciBNYXJrZXRUaXBJdGVtID0gcmVxdWlyZShcIk1hcmtldFRpcEl0ZW1cIik7XHJcbnZhciBNYXJrZXRUaXBQYW5lbCA9IGNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICBUaXBMaXN0OntcclxuICAgICAgICBkZWZhdWx0OltdLFxyXG4gICAgICAgIHR5cGU6W01hcmtldFRpcEl0ZW1dLFxyXG4gICAgICAgfSxcclxuICAgICAgIERlc0xibDpjYy5MYWJlbCxcclxuICAgICAgIEludG9Ob2RlOmNjLk5vZGUsXHJcbiAgICAgICBJbnRvRGVzOmNjLkxhYmVsLFxyXG4gICAgICAgSW50b0Rlc051bGw6Y2MuTm9kZSxcclxuICAgIH0sXHJcblxyXG4gICAgQ2xvc2VQYW5lbDpmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY2MuTWdyLkF1ZGlvTWdyLnBsYXlTRlgoXCJjbGlja1wiKTtcclxuICAgICAgICB0aGlzLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcblxyXG4gICAgICAgIC8v5by55Ye66K6h566X6IKh56Wo5pS255uKXHJcbiAgICAgICAgaWYoY2MuTWdyLlVzZXJEYXRhTWdyLkNhbkdldFN0b2NrUHJvZml0ID09IHRydWUgJiYgY2MuTWdyLmdsb2JhbC5zaG93U3RvY2tQcm9maXQgPT0gdHJ1ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciBib251cyA9IDA7XHJcbiAgICAgICAgICAgIHZhciBJZCA9IC0xO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gY2MuTWdyLlVzZXJEYXRhTWdyLkNvbXBhbnlMaXN0Lmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGEgPSBjYy5NZ3IuVXNlckRhdGFNZ3IuQ29tcGFueUxpc3RbaV07XHJcbiAgICAgICAgICAgICAgICBpZihkYS5zdG9ja051bSA+IDApXHJcbiAgICAgICAgICAgICAgICB7IFxyXG4gICAgICAgICAgICAgICAgICAgIElkID0gZGEuSWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgYm9udXMgKz0gTWF0aC5mbG9vcihkYS5zdG9ja051bSAqIGRhLnN0b2NrUHJpY2UgKiAoZGEuYm9udXNSYXRpbyArIChjYy5NZ3IuVXNlckRhdGFNZ3IuU3RvY2tBZGRCb251cyAvIDEwMCkpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgcGFyYW0gPSB7fTtcclxuICAgICAgICAgICAgcGFyYW0uZm9yV2hhdCA9IFwiU3RvY2tCb251c1wiO1xyXG4gICAgICAgICAgICBwYXJhbS5ib251cyA9IGJvbnVzO1xyXG4gICAgICAgICAgICBwYXJhbS5JZCA9IElkO1xyXG4gICAgICAgICAgICBjYy5kaXJlY3Rvci5HbG9iYWxFdmVudC5lbWl0KGNjLk1nci5FdmVudC5PcGVuQ29tbW9uVGlwICwgcGFyYW0pO1xyXG4gICAgICAgICAgICBjYy5NZ3IuZ2xvYmFsLnNob3dTdG9ja1Byb2ZpdCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihjYy5NZ3IuZ2xvYmFsLnR1dG9yaWFsU3RlcCA9PSAxMSAmJiBjYy5NZ3IuVXNlckRhdGFNZ3IudHV0b3JpYWxJbk1hcmtldCA9PSBmYWxzZSkgIC8v5byV5a+85q2l6aqkIOmHh+eUqCAxMSDooajnpLrnrKzkuIDkuKrlpKfmraXpqqQg56ys5LiA5bCP5q2lXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgZHQgPSB7fTtcclxuICAgICAgICAgICAgZHQuc3RlcCA9IDExO1xyXG4gICAgICAgICAgICBjYy5kaXJlY3Rvci5HbG9iYWxFdmVudC5lbWl0KGNjLk1nci5FdmVudC5PcGVuVHV0b3JpYWwsIGR0KTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIFNob3dQYW5lbDpmdW5jdGlvbihwYXJhbSl7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMuVGlwTGlzdC5sZW5ndGggLSAxOyBpID49IDA7IGktLSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuVGlwTGlzdFtpXS5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLkludG9EZXMuc3RyaW5nID0gXCJcIjtcclxuICAgICAgICB0aGlzLkludG9EZXNOdWxsLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIC8vLTLooajnpLrmmrTot4wgLTHooajnpLrot4zkuoYgIDAg6KGo56S656iz5a6aICAx5pyJ5omA5aKe6ZW/IDLooajnpLrmmrTmtqhcclxuICAgICAgICB2YXIgbGlzdCA9IHRoaXMuQ2hlY2tTaG93RGVzKHBhcmFtKTtcclxuICAgICAgICBpZihsaXN0Lmxlbmd0aCA9PSAwKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy5EZXNMYmwubm9kZS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLkRlc0xibC5zdHJpbmcgPSBjYy5NZ3IuZ2xvYmFsLmdldFRyYW5zbGF0aW9uKFwiTWFya2V0XzI1XCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLkRlc0xibC5ub2RlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8PSBsaXN0Lmxlbmd0aCAtIDE7IGkrKylcclxuICAgICAgICAgICAgeyAgIFxyXG4gICAgICAgICAgICAgICAgdmFyIGRlcyA9IHRoaXMuRGlja0RlcyhsaXN0W2ldLlN0YXRlLCBsaXN0W2ldLm5hbWUsIGxpc3RbaV0uSWQpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5UaXBMaXN0W2ldLm5vZGUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHZhciBwYXIgPSB7fTtcclxuICAgICAgICAgICAgICAgIHBhci5kZXMgPSBkZXM7XHJcbiAgICAgICAgICAgICAgICBwYXIuSWQgPSBsaXN0W2ldLklkO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5UaXBMaXN0W2ldLlNldERhdGEocGFyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICB9IFxyXG4gICAgfSxcclxuXHJcbiAgICBEaWNrRGVzOmZ1bmN0aW9uKFN0YXRlLCBuYW1lLCBJZClcclxuICAgIHtcclxuICAgICAgICB2YXIgZGVzID0gXCJcIjtcclxuICAgICAgICBpZihTdGF0ZSA9PSAwKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIGRlc0lkID0gXCJNYXJrZXRfXCIgKyAoMipJZCAtMSk7XHJcbiAgICAgICAgICAgIC8vZGVzID0gY2MuTWdyLmdsb2JhbC5nZXRUcmFuc2xhdGlvbihkZXNJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYoU3RhdGUgPT0gMilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciBkZXNJZCA9IFwiTWFya2V0X1wiICsgKDIqSWQpO1xyXG4gICAgICAgICAgICAvL2RlcyA9IGNjLk1nci5nbG9iYWwuZ2V0VHJhbnNsYXRpb24oZGVzSWQpOztcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHJlID0ge307XHJcbiAgICAgICAgcmUuU3RhdGUgPSBTdGF0ZTtcclxuICAgICAgICByZS5kZXNJZCA9IGRlc0lkO1xyXG4gICAgICAgIHJldHVybiByZTtcclxuICAgIH0sXHJcblxyXG4gICAgQ2hlY2tTaG93RGVzOmZ1bmN0aW9uKHBhcmFtKXtcclxuICAgICAgICB2YXIgbGlzdCA9IFtdO1xyXG4gICAgICAgIHZhciBjaGVja051bSA9IDA7XHJcbiAgICAgICAgdmFyIHJlbSA9W107XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IHBhcmFtLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcbiAgICAgICAgICAgIGlmKHBhcmFtW2ldLlN0YXRlICE9IG51bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKHBhcmFtW2ldLlN0YXRlICE9IDEpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGlzdC5wdXNoKHBhcmFtW2ldKTtcclxuICAgICAgICAgICAgICAgICAgICBjaGVja051bSArPSAxO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYocGFyYW1baV0uU3RhdGUgIT0gMiAmJiBwYXJhbVtpXS5JZCAhPSAzKSAvL0lkIOS4ujMg5piv5a2X55S76L+Y5piv6buE6YeR5p2l552AXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVtLnB1c2gocGFyYW1baV0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9ICAgICAgXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNjLk1nci5nbG9iYWwuR29vZHNGb3JlSWQgPSAtMTtcclxuICAgICAgICBpZihjaGVja051bSA8PSAzICYmIGNjLk1nci5Vc2VyRGF0YU1nci5BZ2UgPj0gMzAgJiYgcmVtLmxlbmd0aCA+IDApXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgc2VlZCA9IE1hdGgucmFuZG9tKCk7XHJcbiAgICAgICAgICAgIGlmIChzZWVkIDwgMC40KVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHJlbS5sZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgY2MuTWdyLmdsb2JhbC5Hb29kc0ZvcmVJZCA9IHJlbVtkXS5JZDtcclxuICAgICAgICAgICAgICAgIHRoaXMuSW50b0Rlcy5zdHJpbmcgPSBjYy5NZ3IuZ2xvYmFsLmdldFRyYW5zbGF0aW9uKFwiZ29vZHNfXCIrcmVtW2RdLklkKSArIFwi5LiL5LiA5bm05Y+v6IO95Ye6546w5rao5Lu3XCIgK1wiXFxuKOWJjeeeu+aciemjjumZqSznm4jkuo/oh6rotJ8pXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLkludG9EZXNOdWxsLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy5JbnRvRGVzTnVsbC5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbGlzdDtcclxuICAgIH0sXHJcbn0pO1xyXG5tb2R1bGUuZXhwb3J0cyA9IE1hcmtldFRpcFBhbmVsO1xyXG4iXX0=