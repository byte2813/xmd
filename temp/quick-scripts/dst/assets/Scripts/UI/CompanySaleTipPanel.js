
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Scripts/UI/CompanySaleTipPanel.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '57d83pbqw5Jkr7JTDdihURB', 'CompanySaleTipPanel');
// Scripts/UI/CompanySaleTipPanel.js

"use strict";

var ItemType = require("ItemType");
var TempBonus = require("TempBonus");
var CompanySaleTipPanel = cc.Class({
  "extends": cc.Component,
  properties: {
    Atlas: cc.SpriteAtlas,
    IconSp: cc.Sprite,
    TitleName: cc.Sprite,
    SaleNumLbl: cc.Label,
    EarnLbl: cc.Label,
    Slider: cc.Slider,
    InPutBox: cc.EditBox,
    Progress: cc.ProgressBar,
    SaleNum: 0,
    Data: null
  },
  ShowPanel: function ShowPanel(data) {
    this.Data = data;
    this.IconSp.spriteFrame = this.Atlas.getSpriteFrame(data.icon);
    this.TitleName.spriteFrame = this.Atlas.getSpriteFrame(data.name);
    var data = cc.Mgr.UserDataMgr.getDataByItemTypeAndId(ItemType.Company, this.Data.Id);
    var marketPrice = data.stockPrice;
    var cost = data.stockCost;
    this.SaleNum = Math.floor(this.Data.stockNum / 100);
    var money = Math.floor(this.Data.stockNum * (marketPrice - cost));
    if (cc.Mgr.global.TempAdsStockBonus == TempBonus.StockBonus) {
      if (money > 0) money = Math.floor(money * 1.2); //有之前看过广告
    }

    this.EarnLbl.string = cc.Mgr.global.FormatNum(money);
    this.SaleNumLbl.string = this.SaleNum;
    this.InPutBox.string = this.SaleNum;
    this.Slider.progress = 1;
    this.Progress.progress = 1;
  },
  OnSliderChange: function OnSliderChange() {
    this.SaleNum = Math.floor(this.Slider.progress * (this.Data.stockNum / 100));
    this.Progress.progress = this.Slider.progress;
    var data = cc.Mgr.UserDataMgr.getDataByItemTypeAndId(ItemType.Company, this.Data.Id);
    var marketPrice = data.stockPrice;
    var cost = data.stockCost;
    var money = Math.floor(this.SaleNum * 100 * (marketPrice - cost));
    if (cc.Mgr.global.TempAdsStockBonus == TempBonus.StockBonus) {
      if (money > 0) money = Math.floor(money * 1.2); //有之前看过广告
    }

    this.EarnLbl.string = cc.Mgr.global.FormatNum(money);
    this.SaleNumLbl.string = this.SaleNum;
    this.InPutBox.string = this.SaleNum;
  },
  OnInputBoxEnd: function OnInputBoxEnd() {
    if (this.InPutBox.string != "") {
      if (Number(this.InPutBox.string) != null) {
        if (Number(this.InPutBox.string) > Math.floor(this.Data.stockNum / 100)) {
          this.InPutBox.string = Math.floor(this.Data.stockNum / 100);
          this.SaleNum = Math.floor(this.Data.stockNum / 100);
          this.Progress.progress = 1;
          this.Slider.progress = 1;
        } else {
          this.SaleNum = Number(this.InPutBox.string);
          this.Slider.progress = Math.floor(this.SaleNum / (this.Data.stockNum / 100));
          this.Progress.progress = this.Slider.progress;
        }
      }
    } else {
      this.InPutBox.string = "0";
      this.SaleNum = 0;
      this.Progress.progress = 0;
      this.Slider.progress = 0;
    }
    var data = cc.Mgr.UserDataMgr.getDataByItemTypeAndId(ItemType.Company, this.Data.Id);
    var marketPrice = data.stockPrice;
    var cost = data.stockCost;
    var money = Math.floor(this.SaleNum * 100 * (marketPrice - cost));
    if (cc.Mgr.global.TempAdsStockBonus == TempBonus.StockBonus) {
      if (money > 0) money = Math.floor(money * 1.2); //有之前看过广告
    }

    this.EarnLbl.string = cc.Mgr.global.FormatNum(money);
  },
  ClickSaleBtn: function ClickSaleBtn() {
    if (this.SaleNum <= 0) {
      cc.Mgr.AudioMgr.playSFX("click");
      return;
    }
    var data = cc.Mgr.UserDataMgr.getDataByItemTypeAndId(ItemType.Company, this.Data.Id);
    var marketPrice = data.stockPrice;
    var cost = data.stockCost;
    var getMoney = Math.floor(marketPrice * this.SaleNum * 100);
    if (cc.Mgr.global.TempAdsStockBonus == TempBonus.StockBonus) {
      var money = this.SaleNum * (marketPrice - cost);
      if (money > 0) getMoney = Math.floor(getMoney * 1.2); //有之前看过广告
      //cc.Mgr.global.TempAdsBonus = TempBonus.NULL;
    }

    cc.Mgr.UserDataMgr.Cash += getMoney;
    var param = {};
    param.Num = this.SaleNum * 100;
    param.price = marketPrice;
    param.Id = this.Data.Id;
    var data = cc.Mgr.UserDataMgr.SaleStocks(param);
    //通知刷新
    cc.director.GlobalEvent.emit(cc.Mgr.Event.SaleStockSuccess, data);
    this.ClosePanel();
  },
  ClosePanel: function ClosePanel() {
    cc.Mgr.AudioMgr.playSFX("click");
    this.node.active = false;
  }
});
module.exports = CompanySaleTipPanel;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcU2NyaXB0c1xcVUlcXENvbXBhbnlTYWxlVGlwUGFuZWwuanMiXSwibmFtZXMiOlsiSXRlbVR5cGUiLCJyZXF1aXJlIiwiVGVtcEJvbnVzIiwiQ29tcGFueVNhbGVUaXBQYW5lbCIsImNjIiwiQ2xhc3MiLCJDb21wb25lbnQiLCJwcm9wZXJ0aWVzIiwiQXRsYXMiLCJTcHJpdGVBdGxhcyIsIkljb25TcCIsIlNwcml0ZSIsIlRpdGxlTmFtZSIsIlNhbGVOdW1MYmwiLCJMYWJlbCIsIkVhcm5MYmwiLCJTbGlkZXIiLCJJblB1dEJveCIsIkVkaXRCb3giLCJQcm9ncmVzcyIsIlByb2dyZXNzQmFyIiwiU2FsZU51bSIsIkRhdGEiLCJTaG93UGFuZWwiLCJkYXRhIiwic3ByaXRlRnJhbWUiLCJnZXRTcHJpdGVGcmFtZSIsImljb24iLCJuYW1lIiwiTWdyIiwiVXNlckRhdGFNZ3IiLCJnZXREYXRhQnlJdGVtVHlwZUFuZElkIiwiQ29tcGFueSIsIklkIiwibWFya2V0UHJpY2UiLCJzdG9ja1ByaWNlIiwiY29zdCIsInN0b2NrQ29zdCIsIk1hdGgiLCJmbG9vciIsInN0b2NrTnVtIiwibW9uZXkiLCJnbG9iYWwiLCJUZW1wQWRzU3RvY2tCb251cyIsIlN0b2NrQm9udXMiLCJzdHJpbmciLCJGb3JtYXROdW0iLCJwcm9ncmVzcyIsIk9uU2xpZGVyQ2hhbmdlIiwiT25JbnB1dEJveEVuZCIsIk51bWJlciIsIkNsaWNrU2FsZUJ0biIsIkF1ZGlvTWdyIiwicGxheVNGWCIsImdldE1vbmV5IiwiQ2FzaCIsInBhcmFtIiwiTnVtIiwicHJpY2UiLCJTYWxlU3RvY2tzIiwiZGlyZWN0b3IiLCJHbG9iYWxFdmVudCIsImVtaXQiLCJFdmVudCIsIlNhbGVTdG9ja1N1Y2Nlc3MiLCJDbG9zZVBhbmVsIiwibm9kZSIsImFjdGl2ZSIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBSUEsUUFBUSxHQUFHQyxPQUFP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QUFVLEVBQUU7RUFDckIsQ0FBQztFQUVEQSxVQUFVLEVBQUMsU0FBQUEsV0FBQSxFQUFVO0lBQ2pCN0QsRUFBRSxDQUFDeUIsR0FBRyxDQUFDdUIsUUFBUSxDQUFDQyxPQUFPLENBQUMsT0FBTyxDQUFDO0lBQ2hDLElBQUksQ0FBQ2EsSUFBSSxDQUFDQyxNQUFNLEdBQUcsS0FBSztFQUM1QjtBQUVKLENBQUMsQ0FBQztBQUNGQyxNQUFNLENBQUNDLE9BQU8sR0FBR2xFLG1CQUFtQiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsidmFyIEl0ZW1UeXBlID0gcmVxdWlyZShcIkl0ZW1UeXBlXCIpO1xyXG52YXIgVGVtcEJvbnVzID0gcmVxdWlyZShcIlRlbXBCb251c1wiKTtcclxudmFyIENvbXBhbnlTYWxlVGlwUGFuZWwgPSBjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgQXRsYXM6Y2MuU3ByaXRlQXRsYXMsXHJcbiAgICAgICAgSWNvblNwOmNjLlNwcml0ZSxcclxuICAgICAgICBUaXRsZU5hbWU6Y2MuU3ByaXRlLFxyXG4gICAgICAgIFNhbGVOdW1MYmw6Y2MuTGFiZWwsXHJcbiAgICAgICAgRWFybkxibDpjYy5MYWJlbCxcclxuICAgICAgICBTbGlkZXI6Y2MuU2xpZGVyLFxyXG4gICAgICAgIEluUHV0Qm94OmNjLkVkaXRCb3gsXHJcbiAgICAgICAgUHJvZ3Jlc3M6Y2MuUHJvZ3Jlc3NCYXIsXHJcbiAgICAgICAgU2FsZU51bTowLFxyXG4gICAgICAgIERhdGE6bnVsbCxcclxuICAgIH0sXHJcblxyXG4gICAgU2hvd1BhbmVsOmZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgdGhpcy5EYXRhID0gZGF0YTtcclxuICAgICAgICB0aGlzLkljb25TcC5zcHJpdGVGcmFtZSA9IHRoaXMuQXRsYXMuZ2V0U3ByaXRlRnJhbWUoZGF0YS5pY29uKTtcclxuICAgICAgICB0aGlzLlRpdGxlTmFtZS5zcHJpdGVGcmFtZSA9IHRoaXMuQXRsYXMuZ2V0U3ByaXRlRnJhbWUoZGF0YS5uYW1lKTtcclxuXHJcbiAgICAgICAgdmFyIGRhdGEgPSBjYy5NZ3IuVXNlckRhdGFNZ3IuZ2V0RGF0YUJ5SXRlbVR5cGVBbmRJZChJdGVtVHlwZS5Db21wYW55LHRoaXMuRGF0YS5JZCk7XHJcbiAgICAgICAgdmFyIG1hcmtldFByaWNlID0gZGF0YS5zdG9ja1ByaWNlO1xyXG4gICAgICAgIHZhciBjb3N0ID0gZGF0YS5zdG9ja0Nvc3Q7XHJcbiAgICAgICAgdGhpcy5TYWxlTnVtID0gTWF0aC5mbG9vcih0aGlzLkRhdGEuc3RvY2tOdW0gLyAxMDApO1xyXG4gICAgICAgIHZhciBtb25leSA9IE1hdGguZmxvb3IodGhpcy5EYXRhLnN0b2NrTnVtICogKG1hcmtldFByaWNlIC0gY29zdCkpO1xyXG4gICAgICAgIGlmKGNjLk1nci5nbG9iYWwuVGVtcEFkc1N0b2NrQm9udXMgPT0gVGVtcEJvbnVzLlN0b2NrQm9udXMpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihtb25leSA+IDApXHJcbiAgICAgICAgICAgICAgICBtb25leSA9IE1hdGguZmxvb3IobW9uZXkgKiAxLjIpOyAvL+acieS5i+WJjeeci+i/h+W5v+WRilxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLkVhcm5MYmwuc3RyaW5nID0gY2MuTWdyLmdsb2JhbC5Gb3JtYXROdW0obW9uZXkpO1xyXG4gICAgICAgIHRoaXMuU2FsZU51bUxibC5zdHJpbmcgPSB0aGlzLlNhbGVOdW07XHJcbiAgICAgICAgdGhpcy5JblB1dEJveC5zdHJpbmcgPSB0aGlzLlNhbGVOdW07XHJcbiAgICAgICAgdGhpcy5TbGlkZXIucHJvZ3Jlc3MgPSAxO1xyXG4gICAgICAgIHRoaXMuUHJvZ3Jlc3MucHJvZ3Jlc3MgPSAxO1xyXG4gICAgfSxcclxuXHJcbiAgICBPblNsaWRlckNoYW5nZTpmdW5jdGlvbigpe1xyXG4gICAgICAgIHRoaXMuU2FsZU51bSA9IE1hdGguZmxvb3IodGhpcy5TbGlkZXIucHJvZ3Jlc3MgKiAodGhpcy5EYXRhLnN0b2NrTnVtIC8gMTAwKSk7XHJcbiAgICAgICAgdGhpcy5Qcm9ncmVzcy5wcm9ncmVzcyA9IHRoaXMuU2xpZGVyLnByb2dyZXNzO1xyXG4gICAgICAgIHZhciBkYXRhID0gY2MuTWdyLlVzZXJEYXRhTWdyLmdldERhdGFCeUl0ZW1UeXBlQW5kSWQoSXRlbVR5cGUuQ29tcGFueSx0aGlzLkRhdGEuSWQpO1xyXG4gICAgICAgIHZhciBtYXJrZXRQcmljZSA9IGRhdGEuc3RvY2tQcmljZTtcclxuICAgICAgICB2YXIgY29zdCA9IGRhdGEuc3RvY2tDb3N0O1xyXG4gICAgICAgIHZhciBtb25leSA9IE1hdGguZmxvb3IodGhpcy5TYWxlTnVtICogMTAwICogKG1hcmtldFByaWNlIC0gY29zdCkpO1xyXG4gICAgICAgIGlmKGNjLk1nci5nbG9iYWwuVGVtcEFkc1N0b2NrQm9udXMgPT0gVGVtcEJvbnVzLlN0b2NrQm9udXMpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihtb25leSA+IDApXHJcbiAgICAgICAgICAgICAgICBtb25leSA9IE1hdGguZmxvb3IobW9uZXkgKjEuMik7IC8v5pyJ5LmL5YmN55yL6L+H5bm/5ZGKXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuRWFybkxibC5zdHJpbmcgPSBjYy5NZ3IuZ2xvYmFsLkZvcm1hdE51bShtb25leSk7XHJcbiAgICAgICAgdGhpcy5TYWxlTnVtTGJsLnN0cmluZyA9IHRoaXMuU2FsZU51bTtcclxuICAgICAgICB0aGlzLkluUHV0Qm94LnN0cmluZyA9IHRoaXMuU2FsZU51bTtcclxuICAgIH0sXHJcblxyXG4gICAgT25JbnB1dEJveEVuZDpmdW5jdGlvbigpe1xyXG4gICAgICAgIGlmKHRoaXMuSW5QdXRCb3guc3RyaW5nICE9IFwiXCIpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZihOdW1iZXIodGhpcy5JblB1dEJveC5zdHJpbmcpICE9IG51bGwpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKE51bWJlcih0aGlzLkluUHV0Qm94LnN0cmluZykgPiBNYXRoLmZsb29yKHRoaXMuRGF0YS5zdG9ja051bSAvIDEwMCkpIFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuSW5QdXRCb3guc3RyaW5nID0gTWF0aC5mbG9vcih0aGlzLkRhdGEuc3RvY2tOdW0gLyAxMDApO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuU2FsZU51bSA9IE1hdGguZmxvb3IodGhpcy5EYXRhLnN0b2NrTnVtIC8gMTAwKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLlByb2dyZXNzLnByb2dyZXNzID0gMTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLlNsaWRlci5wcm9ncmVzcyA9IDE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5TYWxlTnVtID0gTnVtYmVyKHRoaXMuSW5QdXRCb3guc3RyaW5nKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLlNsaWRlci5wcm9ncmVzcyA9ICBNYXRoLmZsb29yKHRoaXMuU2FsZU51bSAvICh0aGlzLkRhdGEuc3RvY2tOdW0gLyAxMDApKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLlByb2dyZXNzLnByb2dyZXNzID0gdGhpcy5TbGlkZXIucHJvZ3Jlc3M7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy5JblB1dEJveC5zdHJpbmcgPSBcIjBcIjtcclxuICAgICAgICAgICAgdGhpcy5TYWxlTnVtID0gMDtcclxuICAgICAgICAgICAgdGhpcy5Qcm9ncmVzcy5wcm9ncmVzcyA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuU2xpZGVyLnByb2dyZXNzID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGRhdGEgPSBjYy5NZ3IuVXNlckRhdGFNZ3IuZ2V0RGF0YUJ5SXRlbVR5cGVBbmRJZChJdGVtVHlwZS5Db21wYW55LHRoaXMuRGF0YS5JZCk7XHJcbiAgICAgICAgdmFyIG1hcmtldFByaWNlID0gZGF0YS5zdG9ja1ByaWNlO1xyXG4gICAgICAgIHZhciBjb3N0ID0gZGF0YS5zdG9ja0Nvc3Q7XHJcbiAgICAgICAgdmFyIG1vbmV5ID0gTWF0aC5mbG9vcih0aGlzLlNhbGVOdW0gKiAxMDAgKiAobWFya2V0UHJpY2UgLSBjb3N0KSk7XHJcbiAgICAgICAgaWYoY2MuTWdyLmdsb2JhbC5UZW1wQWRzU3RvY2tCb251cyA9PSBUZW1wQm9udXMuU3RvY2tCb251cylcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmKG1vbmV5ID4gMClcclxuICAgICAgICAgICAgICAgIG1vbmV5ID0gTWF0aC5mbG9vcihtb25leSAqMS4yKTsgLy/mnInkuYvliY3nnIvov4flub/lkYpcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5FYXJuTGJsLnN0cmluZyA9IGNjLk1nci5nbG9iYWwuRm9ybWF0TnVtKG1vbmV5KTtcclxuICAgIH0sXHJcblxyXG4gICAgQ2xpY2tTYWxlQnRuOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgaWYodGhpcy5TYWxlTnVtIDw9IDApXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBjYy5NZ3IuQXVkaW9NZ3IucGxheVNGWChcImNsaWNrXCIpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciBkYXRhID0gY2MuTWdyLlVzZXJEYXRhTWdyLmdldERhdGFCeUl0ZW1UeXBlQW5kSWQoSXRlbVR5cGUuQ29tcGFueSx0aGlzLkRhdGEuSWQpO1xyXG4gICAgICAgIHZhciBtYXJrZXRQcmljZSA9IGRhdGEuc3RvY2tQcmljZTtcclxuICAgICAgICB2YXIgY29zdCA9IGRhdGEuc3RvY2tDb3N0O1xyXG4gICAgICAgIHZhciBnZXRNb25leSA9IE1hdGguZmxvb3IobWFya2V0UHJpY2UgKiB0aGlzLlNhbGVOdW0gKiAxMDApO1xyXG4gICAgICAgIGlmKGNjLk1nci5nbG9iYWwuVGVtcEFkc1N0b2NrQm9udXMgPT0gVGVtcEJvbnVzLlN0b2NrQm9udXMpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB2YXIgbW9uZXkgPSB0aGlzLlNhbGVOdW0gKiAobWFya2V0UHJpY2UgLSBjb3N0KTtcclxuICAgICAgICAgICAgaWYobW9uZXkgPiAwKVxyXG4gICAgICAgICAgICAgICAgZ2V0TW9uZXkgPSBNYXRoLmZsb29yKGdldE1vbmV5ICoxLjIpOyAvL+acieS5i+WJjeeci+i/h+W5v+WRilxyXG4gICAgICAgICAgICAvL2NjLk1nci5nbG9iYWwuVGVtcEFkc0JvbnVzID0gVGVtcEJvbnVzLk5VTEw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNjLk1nci5Vc2VyRGF0YU1nci5DYXNoICs9IGdldE1vbmV5O1xyXG4gICAgICAgIHZhciBwYXJhbSA9IHt9O1xyXG4gICAgICAgIHBhcmFtLk51bSA9IHRoaXMuU2FsZU51bSAqIDEwMDtcclxuICAgICAgICBwYXJhbS5wcmljZSA9IG1hcmtldFByaWNlO1xyXG4gICAgICAgIHBhcmFtLklkID0gdGhpcy5EYXRhLklkO1xyXG4gICAgICAgIHZhciBkYXRhID0gY2MuTWdyLlVzZXJEYXRhTWdyLlNhbGVTdG9ja3MocGFyYW0pO1xyXG4gICAgICAgIC8v6YCa55+l5Yi35pawXHJcbiAgICAgICAgY2MuZGlyZWN0b3IuR2xvYmFsRXZlbnQuZW1pdChjYy5NZ3IuRXZlbnQuU2FsZVN0b2NrU3VjY2VzcywgZGF0YSk7XHJcbiAgICAgICAgdGhpcy5DbG9zZVBhbmVsKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIENsb3NlUGFuZWw6ZnVuY3Rpb24oKXtcclxuICAgICAgICBjYy5NZ3IuQXVkaW9NZ3IucGxheVNGWChcImNsaWNrXCIpO1xyXG4gICAgICAgIHRoaXMubm9kZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBcclxufSk7XHJcbm1vZHVsZS5leHBvcnRzID0gQ29tcGFueVNhbGVUaXBQYW5lbDsiXX0=