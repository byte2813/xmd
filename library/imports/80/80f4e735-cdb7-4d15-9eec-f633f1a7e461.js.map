{"version":3,"sources":["assets\\Scripts\\Core\\AudioMgr.js"],"names":["AudioMgr","cc","Class","Component","properties","bgmVolume","sfxVolume","bgmAudioID","musicState","init","Mgr","loadSound","t","sys","localStorage","getItem","parseFloat","game","on","EVENT_HIDE","console","log","audioEngine","pauseAll","EVENT_SHOW","resumeAll","node","Node","getUrl","url","raw","playBGM","_this","stop","resources","load","AudioClip","err","audioClip","audioSource","addComponent","AudioSource","clip","volumn","loop","play","playSFX","_this2","setSFXVolume","v","setItem","setBGMVolume","force","resume","pause","setVolume","getVoiceState"],"mappings":"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","sourceRoot":"/","sourcesContent":["/*\r\n*****Created By Alex 2018 08 24\r\n*/\r\nvar AudioMgr = cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        bgmVolume:0.5,\r\n        sfxVolume:1.0,\r\n        bgmAudioID:-1,\r\n        musicState:1, //1 表示开启 0 表示关闭\r\n    },\r\n\r\n    // use this for initialization\r\n    init: function () {\r\n        cc.Mgr.loadSound = false;\r\n\r\n        var t = cc.sys.localStorage.getItem(\"bgmVolume\");\r\n        if(t != null){\r\n            this.bgmVolume = parseFloat(t);    \r\n        }\r\n        \r\n        var t = cc.sys.localStorage.getItem(\"sfxVolume\");\r\n        if(t != null){\r\n            this.sfxVolume = parseFloat(t);    \r\n        }\r\n        \r\n        cc.game.on(cc.game.EVENT_HIDE, function () {\r\n            console.log(\"cc.audioEngine.pauseAll\");\r\n            cc.audioEngine.pauseAll();\r\n        });\r\n        cc.game.on(cc.game.EVENT_SHOW, function () {\r\n            console.log(\"cc.audioEngine.resumeAll\");\r\n            cc.audioEngine.resumeAll();\r\n        });\r\n        this.node = new cc.Node('audioNode')\r\n    },\r\n\r\n    //获取需要播放某个音效用  根据名字来\r\n    getUrl:function(url){\r\n        return cc.url.raw(\"resources/sound/\" + url + \".mp3\");\r\n    },\r\n\r\n    //播放背景音乐\r\n    playBGM:function(url){\r\n        if(this.bgmAudioID >= 0){\r\n            cc.audioEngine.stop(this.bgmAudioID);\r\n        }\r\n        cc.resources.load('sound/' + url, cc.AudioClip, (err, audioClip) => {\r\n            let audioSource = this.node.addComponent(cc.AudioSource);\r\n            audioSource.clip = audioClip;\r\n            audioSource.volumn = this.bgmVolume\r\n            audioSource.loop = true\r\n            audioSource.play();\r\n        });\r\n    },\r\n    //播放音效\r\n    playSFX:function(url){\r\n        cc.resources.load('sound/' + url, cc.AudioClip, (err, audioClip) => {\r\n            let audioSource = this.node.addComponent(cc.AudioSource);\r\n            audioSource.clip = audioClip;\r\n            audioSource.volumn = this.sfxVolume\r\n            audioSource.loop = false\r\n            audioSource.play();\r\n        });\r\n    },\r\n    //设置音效大小\r\n    setSFXVolume:function(v){\r\n        if(this.sfxVolume != v){\r\n            cc.sys.localStorage.setItem(\"sfxVolume\",v);\r\n            this.sfxVolume = v;\r\n        }\r\n    },\r\n    //设置背景音大小\r\n    setBGMVolume:function(v,force){\r\n        if(this.bgmAudioID >= 0){\r\n            if(v > 0){\r\n                cc.audioEngine.resume(this.bgmAudioID);\r\n            }\r\n            else{\r\n                cc.audioEngine.pause(this.bgmAudioID);\r\n            }\r\n        }\r\n        if(this.bgmVolume != v || force){\r\n            cc.sys.localStorage.setItem(\"bgmVolume\",v);\r\n            this.bgmVolume = v;\r\n            cc.audioEngine.setVolume(this.bgmAudioID,v);\r\n        }\r\n    },\r\n    //暂停\r\n    pauseAll:function(){\r\n        this.musicState = 0;\r\n        this.bgmVolume = 0.0;\r\n        this.sfxVolume = 0.0;\r\n        cc.audioEngine.pauseAll();\r\n\r\n    },\r\n    //恢复\r\n    resumeAll:function(){\r\n        this.musicState = 1;\r\n        this.bgmVolume = 0.5;\r\n        this.sfxVolume = 1.0;\r\n        cc.audioEngine.resumeAll();\r\n    },\r\n\r\n    getVoiceState:function(){\r\n        return this.musicState;\r\n    },\r\n});\r\n"]}