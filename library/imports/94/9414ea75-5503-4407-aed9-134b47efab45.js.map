{"version":3,"sources":["assets\\Scripts\\UI\\SkillPanel.js"],"names":["AdsParam","require","CommonTipPanel","SkillPanel","cc","Class","Component","properties","skillParent_1","Node","skillParent_2","skillParent_3","skillParent_4","itemPre","Prefab","SkillPointLbl","Label","CommonTip","InitPanel","list_1","Mgr","UserDataMgr","getSkillListById","list_2","list_3","list_4","i","length","data","obj","instantiate","parent","active","getComponent","ShowData","RefreshPanel","string","SkillBonusPoint","children_1","children","children_2","children_3","children_4","sc","ShowPanel","ClosePanel","AudioMgr","playSFX","SaveUserData","initData","node","ShowAds","VideoAdsTimes","param","text","testDate","Date","VideoLastTime","toDateString","self","AdsMgr","ShowVideoAds","PointA","out","console","log","module","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var AdsParam = require(\"AdsParam\");\r\nvar CommonTipPanel = require(\"CommonTipPanel\");\r\nvar SkillPanel = cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        skillParent_1:cc.Node,\r\n        skillParent_2:cc.Node,\r\n        skillParent_3:cc.Node,\r\n        skillParent_4:cc.Node,\r\n\r\n        itemPre:cc.Prefab,\r\n\r\n        SkillPointLbl:cc.Label,\r\n\r\n        CommonTip:CommonTipPanel,\r\n    },\r\n\r\n    InitPanel:function(){\r\n        var list_1 = cc.Mgr.UserDataMgr.getSkillListById(1);\r\n        var list_2 = cc.Mgr.UserDataMgr.getSkillListById(2);\r\n        var list_3 = cc.Mgr.UserDataMgr.getSkillListById(3);\r\n        var list_4 = cc.Mgr.UserDataMgr.getSkillListById(4);\r\n\r\n        for (var i = list_1.length - 1; i >= 0; i--) {\r\n            var data = list_1[i];\r\n            var obj = cc.instantiate(this.itemPre);\r\n            obj.parent = this.skillParent_1;\r\n            obj.active = true;\r\n            obj.getComponent(\"SkillItem\").ShowData(data, list_1.length);\r\n        }\r\n\r\n        for (var i = list_2.length - 1; i >= 0; i--) {\r\n            var data = list_2[i];\r\n            var obj = cc.instantiate(this.itemPre);\r\n            obj.parent = this.skillParent_2;\r\n            obj.active = true;\r\n            obj.getComponent(\"SkillItem\").ShowData(data, list_2.length);\r\n        }\r\n\r\n        for (var i = list_3.length - 1; i >= 0; i--) {\r\n            var data = list_3[i];\r\n            var obj = cc.instantiate(this.itemPre);\r\n            obj.parent = this.skillParent_3;\r\n            obj.active = true;\r\n            obj.getComponent(\"SkillItem\").ShowData(data, list_3.length);\r\n        }\r\n\r\n        for (var i = list_4.length - 1; i >= 0; i--) {\r\n            var data = list_4[i];\r\n            var obj = cc.instantiate(this.itemPre);\r\n            obj.parent = this.skillParent_4;\r\n            obj.active = true;\r\n            obj.getComponent(\"SkillItem\").ShowData(data, list_4.length);\r\n        }\r\n    },\r\n\r\n    RefreshPanel:function(){\r\n        this.SkillPointLbl.string = cc.Mgr.UserDataMgr.SkillBonusPoint;\r\n        \r\n        var children_1 = this.skillParent_1.children;\r\n        var children_2 = this.skillParent_2.children;\r\n        var children_3 = this.skillParent_3.children;\r\n        var children_4 = this.skillParent_4.children;\r\n\r\n        var list_1 = cc.Mgr.UserDataMgr.getSkillListById(1);\r\n        var list_2 = cc.Mgr.UserDataMgr.getSkillListById(2);\r\n        var list_3 = cc.Mgr.UserDataMgr.getSkillListById(3);\r\n        var list_4 = cc.Mgr.UserDataMgr.getSkillListById(4);\r\n\r\n        for (var i = children_1.length - 1; i >= 0; i--) {\r\n            var sc = children_1[i].getComponent(\"SkillItem\");\r\n            if(sc != null)\r\n            {\r\n                if(list_1[list_1.length - i - 1] != null)\r\n                {\r\n                    sc.ShowData(list_1[list_1.length - i - 1], list_1.length);\r\n                }\r\n            }\r\n        }\r\n\r\n        for (var i = children_2.length - 1; i >= 0; i--) {\r\n            var sc = children_2[i].getComponent(\"SkillItem\");\r\n            if(sc != null)\r\n            {\r\n                if(list_2[list_2.length - i - 1] != null)\r\n                {\r\n                    sc.ShowData(list_2[list_2.length - i - 1], list_2.length);\r\n                }\r\n            }\r\n        }\r\n\r\n        for (var i = children_3.length - 1; i >= 0; i--) {\r\n            var sc = children_3[i].getComponent(\"SkillItem\");\r\n            if(sc != null)\r\n            {\r\n                if(list_3[list_3.length - i - 1] != null)\r\n                {\r\n                    sc.ShowData(list_3[list_3.length - i - 1], list_3.length);\r\n                }\r\n            }\r\n        }\r\n\r\n        for (var i = children_4.length - 1; i >= 0; i--) {\r\n            var sc = children_4[i].getComponent(\"SkillItem\");\r\n            if(sc != null)\r\n            {\r\n                if(list_4[list_4.length - i - 1] != null)\r\n                {\r\n                    sc.ShowData(list_4[list_4.length - i - 1], list_4.length);\r\n                }\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    ShowPanel:function () {\r\n        var children = this.skillParent_1.children;\r\n        this.SkillPointLbl.string = cc.Mgr.UserDataMgr.SkillBonusPoint;\r\n        if(children.length == 0)\r\n        {\r\n            //cc.log(\"第一次初始化\");\r\n            this.InitPanel();\r\n        }\r\n        else\r\n        {\r\n            //cc.log(\"刷新============\");\r\n            this.RefreshPanel();\r\n        }\r\n    },\r\n\r\n    ClosePanel:function(){\r\n        cc.Mgr.AudioMgr.playSFX(\"click\");\r\n        cc.Mgr.UserDataMgr.SaveUserData();\r\n        cc.Mgr.UserDataMgr.initData();\r\n        this.node.active = false;\r\n    },\r\n\r\n    ShowAds:function()\r\n    {\r\n        cc.Mgr.AudioMgr.playSFX(\"click\");\r\n        \r\n        if(cc.Mgr.UserDataMgr.VideoAdsTimes >= 3)\r\n        {\r\n            this.CommonTip.node.active = true;\r\n            var param = {};\r\n            param.text = \"今天的广告次数已经用完。明天再来\";\r\n            var testDate = new Date();\r\n            cc.Mgr.UserDataMgr.VideoLastTime = testDate.toDateString();\r\n            this.CommonTip.ShowPanel(param);\r\n        }\r\n        else\r\n        {\r\n            var self = this;\r\n            cc.Mgr.AdsMgr.ShowVideoAds(AdsParam.PointA, function(out){\r\n                if(out == 0)\r\n                {\r\n                    cc.Mgr.UserDataMgr.SkillBonusPoint += 150;\r\n                    cc.Mgr.UserDataMgr.VideoAdsTimes += 1;\r\n                    self.RefreshPanel();\r\n                    self.SkillPointLbl.string = cc.Mgr.UserDataMgr.SkillBonusPoint;\r\n                }\r\n                else\r\n                {\r\n                    console.log(\"视频广告没有看完或者加载出错\");\r\n                }\r\n            });\r\n            \r\n        }\r\n        \r\n\r\n        //this.CommonTip.node.active = true;\r\n        //var param = {};\r\n        //param.text = \"目前广告还未开放，敬请期待\";\r\n        //this.CommonTip.ShowPanel(param);\r\n    },\r\n\r\n});\r\nmodule.exports = SkillPanel;\r\n"]}