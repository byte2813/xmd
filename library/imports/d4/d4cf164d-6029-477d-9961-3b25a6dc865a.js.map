{"version":3,"sources":["assets\\Scripts\\UI\\CompanyBuyTipPanel.js"],"names":["CompanyBuyTipPanel","cc","Class","Component","properties","Atlas","SpriteAtlas","IconSp","Sprite","TitleName","BuyNumLbl","Label","DesLbl","Slider","InPutBox","EditBox","Progress","ProgressBar","BuyNum","Data","ShowPanel","data","spriteFrame","getSpriteFrame","icon","name","Math","floor","Mgr","UserDataMgr","Cash","stockPrice","money","string","global","FormatNum","progress","ClickBuyBtn","AudioMgr","playSFX","param","Num","price","Id","BuyStocks","director","GlobalEvent","emit","Event","BuyStockSuccess","ClosePanel","OnSliderChange","OnInputBoxEnd","MaxNum","Number","node","active","module","exports"],"mappings":";;;;;;AACA,IAAIA,kBAAkB,GAAGC,EAAE,CAACC,KAAK,CAAC;EAC9B,WAASD,EAAE,CAACE,SAAS;EAErBC,UAAU,EAAE;IACRC,KAAK,EAACJ,EAAE,CAACK,WAAW;IACpBC,MAAM,EAACN,EAAE,CAACO,MAAM;IAChBC,SAAS,EAACR,EAAE,CAACO,MAAM;IACnBE,SAAS,EAACT,EAAE,CAACU,KAAK;IAClBC,MAAM,EAACX,EAAE,CAACU,KAAK;IACfE,MAAM,EAACZ,EAAE,CAACY,MAAM;IAChBC,QAAQ,EAACb,EAAE,CAACc,OAAO;IACnBC,QAAQ,EAACf,EAAE,CAACgB,WAAW;IACvBC,MAAM,EAAC,CAAC;IACRC,IAAI,EAAC;EACT,CAAC;EAEDC,SAAS,EAAC,SAAAA,UAAUC,IAAI,EAAE;IACzB,IAAI,CAACF,IAAI,GAAGE,IAAI;IACb,IAAI,CAACd,MAAM,CAACe,WAAW,GAAG,IAAI,CAACjB,KAAK,CAACkB,cAAc,CAACF,IAAI,CAACG,IAAI,CAAC;IAC9D,IAAI,CAACf,SAAS,CAACa,WAAW,GAAG,IAAI,CAACjB,KAAK,CAACkB,cAAc,CAACF,IAAI,CAACI,IAAI,CAAC;IACjE,IAAI,CAACP,MAAM,GAAGQ,IAAI,CAACC,KAAK,CAAC1B,EAAE,CAAC2B,GAAG,CAACC,WAAW,CAACC,IAAI,IAAI,IAAI,CAACX,IAAI,CAACY,UAAU,GAAG,GAAG,CAAC,CAAC;IAChF,IAAIC,KAAK,GAAGN,IAAI,CAACC,KAAK,CAAC,IAAI,CAACT,MAAM,GAAG,GAAG,GAAG,IAAI,CAACC,IAAI,CAACY,UAAU,CAAC;IAChE,IAAI,CAACnB,MAAM,CAACqB,MAAM,GAAGhC,EAAE,CAAC2B,GAAG,CAACM,MAAM,CAACC,SAAS,CAACH,KAAK,CAAC;IACnD,IAAI,CAACtB,SAAS,CAACuB,MAAM,GAAG,IAAI,CAACf,MAAM;IACnC,IAAI,CAACJ,QAAQ,CAACmB,MAAM,GAAG,IAAI,CAACf,MAAM;IAClC,IAAI,CAACL,MAAM,CAACuB,QAAQ,GAAG,CAAC;IACxB,IAAI,CAACpB,QAAQ,CAACoB,QAAQ,GAAG,CAAC;EAC9B,CAAC;EAEDC,WAAW,EAAC,SAAAA,YAAA,EAAU;IAClB,IAAG,IAAI,CAACnB,MAAM,IAAI,CAAC,EACnB;MACIjB,EAAE,CAAC2B,GAAG,CAACU,QAAQ,CAACC,OAAO,CAAC,OAAO,CAAC;MAChC;IACJ;IAEAtC,EAAE,CAAC2B,GAAG,CAACC,WAAW,CAACC,IAAI,IAAIJ,IAAI,CAACC,KAAK,CAAC,IAAI,CAACR,IAAI,CAACY,UAAU,IAAI,IAAI,CAACb,MAAM,GAAG,GAAG,CAAC,CAAC;IACjF,IAAIsB,KAAK,GAAG,CAAC,CAAC;IACdA,KAAK,CAACC,GAAG,GAAG,IAAI,CAACvB,MAAM,GAAG,GAAG;IAC7BsB,KAAK,CAACE,KAAK,GAAG,IAAI,CAACvB,IAAI,CAACY,UAAU;IAClCS,KAAK,CAACG,EAAE,GAAG,IAAI,CAACxB,IAAI,CAACwB,EAAE;IACvB,IAAItB,IAAI,GAAGpB,EAAE,CAAC2B,GAAG,CAACC,WAAW,CAACe,SAAS,CAACJ,KAAK,CAAC;IAC9C;IACAvC,EAAE,CAAC4C,QAAQ,CAACC,WAAW,CAACC,IAAI,CAAC9C,EAAE,CAAC2B,GAAG,CAACoB,KAAK,CAACC,eAAe,EAAE5B,IAAI,CAAC;IAChE,IAAI,CAAC6B,UAAU,EAAE;EACrB,CAAC;EAEDC,cAAc,EAAC,SAAAA,eAAA,EAAU;IACrB,IAAI,CAACjC,MAAM,GAAGQ,IAAI,CAACC,KAAK,CAAC,IAAI,CAACd,MAAM,CAACuB,QAAQ,GAAGnC,EAAE,CAAC2B,GAAG,CAACC,WAAW,CAACC,IAAI,IAAI,IAAI,CAACX,IAAI,CAACY,UAAU,GAAG,GAAG,CAAC,CAAC;IACvG,IAAI,CAACf,QAAQ,CAACoB,QAAQ,GAAG,IAAI,CAACvB,MAAM,CAACuB,QAAQ;IAC7C,IAAI,CAACxB,MAAM,CAACqB,MAAM,GAAGhC,EAAE,CAAC2B,GAAG,CAACM,MAAM,CAACC,SAAS,CAACT,IAAI,CAACC,KAAK,CAAC,IAAI,CAACT,MAAM,GAAG,IAAI,CAACC,IAAI,CAACY,UAAU,GAAG,GAAG,CAAC,CAAC;IAClG,IAAI,CAACrB,SAAS,CAACuB,MAAM,GAAG,IAAI,CAACf,MAAM;IACnC,IAAI,CAACJ,QAAQ,CAACmB,MAAM,GAAG,IAAI,CAACf,MAAM;EACtC,CAAC;EAEDkC,aAAa,EAAC,SAAAA,cAAA,EAAU;IACpB,IAAIC,MAAM,GAAG3B,IAAI,CAACC,KAAK,CAAC1B,EAAE,CAAC2B,GAAG,CAACC,WAAW,CAACC,IAAI,IAAI,IAAI,CAACX,IAAI,CAACY,UAAU,GAAG,GAAG,CAAC,CAAC;IAC/E,IAAG,IAAI,CAACjB,QAAQ,CAACmB,MAAM,IAAI,EAAE,EAC7B;MACI,IAAGqB,MAAM,CAAC,IAAI,CAACxC,QAAQ,CAACmB,MAAM,CAAC,IAAI,IAAI,EACvC;QACI,IAAGqB,MAAM,CAAC,IAAI,CAACxC,QAAQ,CAACmB,MAAM,CAAC,GAAGoB,MAAM,EACxC;UACI,IAAI,CAACvC,QAAQ,CAACmB,MAAM,GAAGoB,MAAM;UAC7B,IAAI,CAACnC,MAAM,GAAGmC,MAAM;UACpB,IAAI,CAACrC,QAAQ,CAACoB,QAAQ,GAAG,CAAC;UAC1B,IAAI,CAACvB,MAAM,CAACuB,QAAQ,GAAG,CAAC;QAC5B,CAAC,MAED;UACI,IAAI,CAAClB,MAAM,GAAGoC,MAAM,CAAC,IAAI,CAACxC,QAAQ,CAACmB,MAAM,CAAC;UAC1C,IAAI,CAACpB,MAAM,CAACuB,QAAQ,GAAI,IAAI,CAAClB,MAAM,GAAGmC,MAAM;UAC5C,IAAI,CAACrC,QAAQ,CAACoB,QAAQ,GAAG,IAAI,CAACvB,MAAM,CAACuB,QAAQ;QACjD;MACJ;IACJ,CAAC,MAED;MACI,IAAI,CAACtB,QAAQ,CAACmB,MAAM,GAAG,GAAG;MAC1B,IAAI,CAACf,MAAM,GAAG,CAAC;MACf,IAAI,CAACF,QAAQ,CAACoB,QAAQ,GAAG,CAAC;MAC1B,IAAI,CAACvB,MAAM,CAACuB,QAAQ,GAAG,CAAC;IAC5B;IACA,IAAI,CAACxB,MAAM,CAACqB,MAAM,GAAGhC,EAAE,CAAC2B,GAAG,CAACM,MAAM,CAACC,SAAS,CAACT,IAAI,CAACC,KAAK,CAAC,IAAI,CAACT,MAAM,GAAG,IAAI,CAACC,IAAI,CAACY,UAAU,GAAG,GAAG,CAAC,CAAC;EACtG,CAAC;EAEDmB,UAAU,EAAC,SAAAA,WAAA,EAAU;IACjBjD,EAAE,CAAC2B,GAAG,CAACU,QAAQ,CAACC,OAAO,CAAC,OAAO,CAAC;IAChC,IAAI,CAACgB,IAAI,CAACC,MAAM,GAAG,KAAK;EAC5B;AAEJ,CAAC,CAAC;AACFC,MAAM,CAACC,OAAO,GAAG1D,kBAAkB","sourceRoot":"/","sourcesContent":["\r\nvar CompanyBuyTipPanel = cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        Atlas:cc.SpriteAtlas,\r\n        IconSp:cc.Sprite,\r\n        TitleName:cc.Sprite,\r\n        BuyNumLbl:cc.Label,\r\n        DesLbl:cc.Label,\r\n        Slider:cc.Slider,\r\n        InPutBox:cc.EditBox,\r\n        Progress:cc.ProgressBar,\r\n        BuyNum:0,\r\n        Data:null,\r\n    },\r\n\r\n    ShowPanel:function (data) {\r\n    \tthis.Data = data;\r\n        this.IconSp.spriteFrame = this.Atlas.getSpriteFrame(data.icon);\r\n        this.TitleName.spriteFrame = this.Atlas.getSpriteFrame(data.name);\r\n        this.BuyNum = Math.floor(cc.Mgr.UserDataMgr.Cash / (this.Data.stockPrice * 100));\r\n        var money = Math.floor(this.BuyNum * 100 * this.Data.stockPrice);\r\n        this.DesLbl.string = cc.Mgr.global.FormatNum(money);\r\n        this.BuyNumLbl.string = this.BuyNum;\r\n        this.InPutBox.string = this.BuyNum;\r\n        this.Slider.progress = 1;\r\n        this.Progress.progress = 1;\r\n    },\r\n\r\n    ClickBuyBtn:function(){\r\n        if(this.BuyNum <= 0)\r\n        {\r\n            cc.Mgr.AudioMgr.playSFX(\"click\");\r\n            return;\r\n        }\r\n        \r\n        cc.Mgr.UserDataMgr.Cash -= Math.floor(this.Data.stockPrice * (this.BuyNum * 100));\r\n        var param = {};\r\n        param.Num = this.BuyNum * 100;\r\n        param.price = this.Data.stockPrice;\r\n        param.Id = this.Data.Id;\r\n        var data = cc.Mgr.UserDataMgr.BuyStocks(param);\r\n        //通知刷新现金\r\n        cc.director.GlobalEvent.emit(cc.Mgr.Event.BuyStockSuccess, data);\r\n        this.ClosePanel();\r\n    },\r\n\r\n    OnSliderChange:function(){\r\n        this.BuyNum = Math.floor(this.Slider.progress * cc.Mgr.UserDataMgr.Cash / (this.Data.stockPrice * 100));\r\n        this.Progress.progress = this.Slider.progress;\r\n        this.DesLbl.string = cc.Mgr.global.FormatNum(Math.floor(this.BuyNum * this.Data.stockPrice * 100));\r\n        this.BuyNumLbl.string = this.BuyNum;\r\n        this.InPutBox.string = this.BuyNum;\r\n    },\r\n\r\n    OnInputBoxEnd:function(){\r\n        var MaxNum = Math.floor(cc.Mgr.UserDataMgr.Cash / (this.Data.stockPrice * 100));\r\n        if(this.InPutBox.string != \"\")\r\n        {\r\n            if(Number(this.InPutBox.string) != null)\r\n            {\r\n                if(Number(this.InPutBox.string) > MaxNum) \r\n                {\r\n                    this.InPutBox.string = MaxNum;\r\n                    this.BuyNum = MaxNum;\r\n                    this.Progress.progress = 1;\r\n                    this.Slider.progress = 1;\r\n                }\r\n                else\r\n                {\r\n                    this.BuyNum = Number(this.InPutBox.string);\r\n                    this.Slider.progress =  this.BuyNum / MaxNum;\r\n                    this.Progress.progress = this.Slider.progress;\r\n                }\r\n            }\r\n        }\r\n        else\r\n        {\r\n            this.InPutBox.string = \"0\";\r\n            this.BuyNum = 0;\r\n            this.Progress.progress = 0;\r\n            this.Slider.progress = 0;\r\n        }\r\n        this.DesLbl.string = cc.Mgr.global.FormatNum(Math.floor(this.BuyNum * this.Data.stockPrice * 100));\r\n    },\r\n\r\n    ClosePanel:function(){\r\n        cc.Mgr.AudioMgr.playSFX(\"click\");\r\n        this.node.active = false;\r\n    },\r\n   \r\n});\r\nmodule.exports = CompanyBuyTipPanel;\r\n"]}