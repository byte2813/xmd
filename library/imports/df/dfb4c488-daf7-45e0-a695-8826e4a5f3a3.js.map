{"version":3,"sources":["assets\\Scripts\\DataMap\\Skill\\SkillMapDecoder.js"],"names":["SkillData","require","CostData","SkillMapDecoder","cc","Class","Component","properties","jsonName","skillList","type","DecodeJson","event","self","reCb","loader","loadRes","error","obj","jsonRoot","json","skill","i","length","skillData","Id","subId","icon","desId","name","skillType","upLevel","upCostList","j","costD","cost","toLevel","addBonus","getDataByName","data","getDataByItemId","itemId","getJsonLength","getDataList","getUpgradeCostByTwoId","tolv","Cost","dt","getSkillAddBonusByTwoIdAndLv","lv","bonus","getSkillDataByTwoId","getSkillListById","param","push","module","exports"],"mappings":"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","sourceRoot":"/","sourcesContent":["var SkillData = require(\"SkillData\");\r\nvar CostData = require(\"CostData\");\r\nvar SkillMapDecoder = cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        jsonName:\"skill\",\r\n        skillList:{\r\n            default:[],\r\n            type:[SkillData],\r\n        },\r\n    },\r\n\r\n    //解析数据\r\n    DecodeJson:function (event) {\r\n        //cc.log(\"===解析技能数据===\");\r\n        var self = this;\r\n        self.reCb = event;\r\n        cc.loader.loadRes(\"json/\"+self.jsonName, function (error, obj) {\r\n            if(error)\r\n            {\r\n                //cc.log(\"+++解析出错，查下json+++\" + error);\r\n                self.reCb(false);\r\n                return;\r\n            }\r\n            \r\n            var jsonRoot = obj.json.skill;\r\n            //cc.log(\"===数据长度===\" + jsonRoot.length);\r\n            for (var i = 0; i < jsonRoot.length; i++) {\r\n                var skillData = new SkillData();\r\n                skillData.Id = jsonRoot[i].Id;\r\n                skillData.subId = jsonRoot[i].subId;\r\n                skillData.icon = jsonRoot[i].icon;\r\n                skillData.desId = jsonRoot[i].desId;\r\n                skillData.name = jsonRoot[i].name;\r\n                skillData.skillType = jsonRoot[i].skillType;\r\n                skillData.upLevel = jsonRoot[i].upCostList.length;//jsonRoot[i].upLevel;\r\n                for (var j = 0; j < jsonRoot[i].upCostList.length; j++) {\r\n                    var costD = new CostData();\r\n                    costD.cost = jsonRoot[i].upCostList[j][2];\r\n                    costD.toLevel = jsonRoot[i].upCostList[j][0];\r\n                    costD.addBonus = jsonRoot[i].upCostList[j][1];\r\n                    skillData.upCostList[j] = costD;\r\n                }\r\n                self.skillList[i] = skillData; \r\n            }\r\n            self.reCb(true);\r\n        });\r\n    },\r\n\r\n    //通过名字拿到当前的数据 不建议用，你要用我也没办法\r\n    getDataByName:function (name) {\r\n        var data = null;\r\n        for (var i = this.skillList.length - 1; i >= 0; i--) {\r\n            if(name == this.skillList[i].name)\r\n            {\r\n                data = this.skillList[i];\r\n                break;\r\n            }\r\n        }\r\n        return data;\r\n    },\r\n\r\n    //通过itemid获取数据\r\n    getDataByItemId:function(itemId){\r\n        var data = null;\r\n        for (var i = this.skillList.length - 1; i >= 0; i--) {\r\n            if(itemId == this.skillList[i].Id)\r\n            {\r\n                data = this.skillList[i];\r\n                break;\r\n            }\r\n        }\r\n        return data;\r\n    },\r\n\r\n    getJsonLength:function(){\r\n        return this.skillList.length\r\n    },\r\n\r\n    getDataList:function(){\r\n        return this.skillList;\r\n    },\r\n\r\n    //获取升级技能消费数据 需要提供两个 Id\r\n    getUpgradeCostByTwoId:function(Id,subId,tolv){\r\n        var Cost = 20;\r\n        for (var i = this.skillList.length - 1; i >= 0; i--) {\r\n            var data = this.skillList[i];\r\n            if(data.Id == Id && data.subId == subId)\r\n            {\r\n                for (var i = data.upCostList.length - 1; i >= 0; i--) {\r\n                    var dt = data.upCostList[i];\r\n                    if(dt.toLevel == tolv)\r\n                    {\r\n                        //cc.log(\"Id subId toLv 花费技能点===================\" + dt.cost + \" \" + tolv);\r\n                        Cost = dt.cost;\r\n                        return dt.cost;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return Cost;\r\n    },\r\n\r\n    getSkillAddBonusByTwoIdAndLv:function(Id,subId,lv){\r\n        var bonus = 0;\r\n        for (var i = this.skillList.length - 1; i >= 0; i--) {\r\n            var data = this.skillList[i];\r\n            if(data.Id == Id && data.subId == subId)\r\n            {\r\n                for (var i = data.upCostList.length - 1; i >= 0; i--) {\r\n                    var dt = data.upCostList[i];\r\n                    if(dt.toLevel == lv)\r\n                    {\r\n                        bonus = dt.addBonus;\r\n                        return dt.addBonus;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return bonus;\r\n    },\r\n\r\n    getSkillDataByTwoId:function(Id, subId){\r\n        var dt = null;\r\n        for (var i = this.skillList.length - 1; i >= 0; i--) {\r\n            var data = this.skillList[i];\r\n            if(data.Id == Id && data.subId == subId)\r\n            {\r\n                dt = data;\r\n                return data;\r\n            }\r\n        }\r\n        return dt;\r\n    },\r\n\r\n    getSkillListById:function(Id){\r\n        var param = [];\r\n        for (var i = this.skillList.length - 1; i >= 0; i--) {\r\n            var data = this.skillList[i];\r\n            if(data.Id == Id)\r\n            {\r\n                param.push(data);\r\n            }\r\n        }\r\n        return param;\r\n    },\r\n\r\n});\r\nmodule.exports = SkillMapDecoder;"]}